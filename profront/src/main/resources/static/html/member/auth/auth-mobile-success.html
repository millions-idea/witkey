<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">

    <link rel="stylesheet" type="text/css" href="../../../dist/css/index-skin.css">
    <link rel="stylesheet" type="text/css" href="../../../dist/css/index-tp.css">

    <script type="text/javascript" src="../../../dist/js/lang.js"></script>
    <script type="text/javascript" src="../../../dist/js/config.js"></script>
    <script type="text/javascript" src="../../../dist/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="../../../dist/js/common.js"></script>

    <script type="text/javascript" src="../../../dist/js/admin.js"></script>
    <script type="text/javascript" src="../../../dist/js/page.js"></script>

    <link rel="stylesheet" type="text/css" href="../../../dist/css/jq-tip.css">
    <script type="text/javascript" src="../../../dist/js/jq-tip.js"></script>
    <script type="text/javascript" src="../../../dist/js/layer.js"></script>

    <script type="text/javascript" src="../../../dist/js/jquery.form.js"></script>
    <script type="text/javascript" src="../../../dist/js/template7.min.js"></script>
    <script type="text/javascript" src="../../../dist/js/cm.js"></script>
    <script type="text/javascript" src="../../../dist/js/ypfunction.js"></script>

    <link rel="stylesheet" href="http://001.topaaa.com/file/script/layim/css/layui.css">
    <script src="http://001.topaaa.com/file/script/layim/layui.js"></script>
    <script src="http://001.topaaa.com/file/script/layim/func.js"></script>
</head>


<body class="rwdt_bg">
<div id="body">
    <div id="body_header"></div>
    <script>
        $("#body_header").load("../public/public-top.html");
    </script>
<div id="content_wrapper">
    <div id="content_body_title"></div>
    <script>
        $("#content_body_title").load("../public/public-body-title.html");
    </script>
    <div id="ypcon" class="validate">
    <script type="text/javascript">s('sms');</script>
    <div class="menu">
        <table cellpadding="0" cellspacing="0">
            <tr>
                <td class="tab"><a id="m1" th:href="@{/member/realMobile}"><span>1、发送认证码</span></a></td>
                <td class="tab"><a id="m2" th:href="@{/member/inputRealMobile}"><span>2、接收认证码</span></a></td>
                <td class="tab_on"><a id="m3" onclick="javascript:;"><span>3、通过验证</span></a></td>
            </tr>
        </table>
    </div>
    <form method="post" th:action="@{/member/realMobile}" onsubmit="return check();" id="dform">
        <table cellpadding="6" cellspacing="1" class="tb">
            <tr>
                <td class="tl">提示信息</td>
                <td class="tr" style="color: red;" th:text="${err_msg}">
                    恭喜认证手机完成!
                </td>
            </tr>
            <tr>
                <td class="tl">&nbsp;</td>
                <td class="tr" height="30">
                    <button type="button"
                            onclick="javascript:window.location.href='/member/memberIndex'" class="btn">
                        回首页
                    </button>
                </td>
            </tr>
        </table>
    </form>
    <script type="text/javascript">
        function check() {
            if (Dd('auth').value.length < 6) {
                Dmsg('请填写认证码', 'auth');
                return false;
            }
            return true;
        }
        $(function () {
            set_nav("m3", "sb0");
        });
    </script>
</div>
</div>
    <div style="clear:both;"></div>
    <div id="footer">
        <div id="footer_top">
            <div id="foot_top_1">
                <a href="/about/index.php?itemid=10">代理加盟</a><span>  |  </span>
                <a href="/about/index.php?itemid=9">辅助业务</a><span>  |  </span>
                <a href="/about/index.php?itemid=8">网站活动</a><span>  |  </span>
                <a href="/about/index.php?itemid=7">联系客服</a><span>  |  </span>
                <a href="/about/index.php?itemid=6">联盟网规</a><span>  |  </span>
                <a href="/about/index.php?itemid=1">关于我们</a><span>  |  </span>
                <a href="/about/index.php?itemid=3">联系方式</a><span>  |  </span>
                <a href="/about/index.php?itemid=4">使用协议</a><span>  |  </span>
                <a href="/about/index.php?itemid=5">版权隐私</a><span>  |  </span>
            </div>
            <div id="copy_right">
                (c)2013-2018 销量联盟 www.topaaa.com All Rights Reserved        </div>
            <div style="width:1024px;text-align: center;margin: 20px auto 0;">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/1.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/2.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/3.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/4.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/5.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/6.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/7.png">
                <img src="http://001.topaaa.com/skin/ypmili/css/img/rz/8.png">
            </div>
            <div style="clear:both;"></div>
        </div>
    </div>
</div>
<script>
    var IM = {};
    var mineId;
    var mineUsername;
    //登录
    mineId = 'temp2018_济南';
    mineUsername = 'temp2018 济南';
    layui.use('layim', function (layim) {
        IM = layim;
        var init_data = {
            mine: {
                "username": mineUsername //我的昵称
                , "id": mineId //我的ID
                , "status": "online" //在线状态 online：在线、hide：隐身
                , "remark": "欢迎使用销量联盟 www.topaaa.com" //我的签名
                , "avatar": "/api/avatar/show.php?username=temp2018&size=middle" //我的头像
            }
            , friend: [
                {
                    "groupname": "人工客服",
                    "id": 1,
                    "online": 1,
                    'spread': 'true',
                    "list": [
                        {
                            "username": "销量联盟 - 售前咨询",
                            "id": 618,
                            "avatar": "/member/image/kefu.png",
                            "sign": '有问题，随时咨询我'
                        }
                    ]
                }
                , {
                    "groupname": "机器人客服",
                    "id": -1,
                    "online": 1,
                    "list": [
                        {
                            "username": "客服 - 潇潇",
                            "id": -1,
                            "avatar": "/member/image/kefu1.png",
                            "sign": '销量联盟智能机器人'
                        },
                        {
                            "username": "客服 - 靓靓 ",
                            "id": -2,
                            "avatar": "/member/image/kefu2.png",
                            "sign": '销量联盟智能机器人'
                        },
                        {
                            "username": "客服 - 恋恋",
                            "id": -3,
                            "avatar": "/member/image/kefu3.jpg",
                            "sign": '销量联盟智能机器人'
                        },
                        {
                            "username": "客服 - 萌萌",
                            "id": -4,
                            "avatar": "/member/image/kefu4.jpg",
                            "sign": '销量联盟智能机器人'
                        }
                    ]
                }
            ]
        };
        layim.on('ready', function (options) {
            $(function () {
                spread(0);
                spread(1);
                function spread(eq) {
                    var isspread = $('.layim-list-friend').children().eq(eq).find('h5').attr('lay-type');
                    if (isspread !== 'true') {
                        $('.layim-list-friend').children().eq(eq).find('.layui-layim-list').addClass('layui-show')
                            .prev().attr('lay-type', 'true').find('.layui-icon').html('&#xe61a;')
                    }
                }
                $('.ypui_sign').each(function () {
                    $(this).val(getCookie('layui_sign_' + $(this).data('username')));
                });
                $('.ypui_sign').bind('input', function () {
                    setCookie('layui_sign_' + $(this).data('username'), $(this).val());
                });
                $('.ypui_sign').click(function (event) {
                    event.stopPropagation();
                });
            });
        });
        var ws = new WebSocket('ws://ws.100dianshang.com:3000');
        var client_id = '';
        ws.onopen = function () {
            setInterval(function () {//心跳包
                ws.send('');
            }, 15000);
        };
        ws.onmessage = function (res) {
            var data = JSON.parse(res.data);
            //console.log(res.data);
            if (data.type === 'init') {
                client_id = data.client_id;
                $.post('\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x78\x69\x6E\x78\x69\x6E\x31\x31\x36\x2E\x63\x6E\x2F\x69\x6D\x2F', {
                    type: 'reg'
                    , client_id: client_id
                    , content: {
                        uid: mineId,
                        username: mineUsername,
                        area: '山东省济南市 移动'
                    }
                });
            }
            if (data.type === 'getMessage') {
                layim.getMessage(data.content);
            }
        };
        //基础配置
        layim.config({
            init: init_data
            //上传图片接口
            , uploadImage: {
                url: '/upload/image' //（返回的数据格式见下文）
                , type: '' //默认post
            }
            , title: '我的会话'
            , right: '20px'
            , initSkin: '2.jpg' //1-5 设置初始背景
            , isgroup: false //是否开启群组
            , notice: true //是否开启桌面消息提醒，默认false
            , copyright: true
        });
        //监听发送消息
        layim.on('sendMessage', function (res) {
            var To = res.to;
            if (To.id != 618) {
                layim.setChatStatus('<span style="color:#FF5722;">对方正在输入。。。</span>');
                //演示自动回复
                $.getJSON('/api/qingyunke.php?kwd=' + encodeURIComponent(res.mine.content), function (txt) {
                    var obj = {
                        username: To.name
                        , avatar: To.avatar
                        , id: To.id
                        , type: To.type
                        , content: txt.content.replace(/{br}/g, '\n').replace(/梅州行/g, '销量联盟')
                    };
                    layim.setChatStatus('<span style="color:#FF5722;">在线</span>');
                    layim.getMessage(obj);
                });
            } else {
                if (To.id == 618) {
                    //res.to.type = 'history';
                    //res.mine.username = res.mine.id;
                }
                //console.log(res);
                $.post('\x68\x74\x74\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x78\x69\x6E\x78\x69\x6E\x31\x31\x36\x2E\x63\x6E\x2F\x69\x6D\x2F', {
                    type: 'chatMessage'
                    , client_id: client_id
                    , content: res
                }, function (data) {
                    //console.log(data);
                });
            }
        });
        //监听聊天窗口的切换
        layim.on('chatChange', function (obj) {
            if (obj.data.id < 0 || obj.data.id === 618) {
                var cache = layui.layim.cache();
                var local = layui.data('layim')[cache.mine.id];
                //console.log('local');
                //console.log(local);
                if (!local.hasOwnProperty('chatlog') || !local.chatlog.hasOwnProperty('friend' + obj.data.id)) {
                    layim.setChatStatus('<span style="color:#FF5722;">对方正在输入。。。</span>');
                    setTimeout(function () {
                        var message = {
                            username: obj.data.name
                            , avatar: obj.data.avatar
                            , id: obj.data.id
                            , type: obj.data.type
                        };
                        if (obj.data.id < 0) {
                            message.content = '您好\n我是机器人' + obj.data.name + '\n我上知天文下晓地理\n和我随笔聊点什么吧';
                        } else if (obj.data.id === 618) {
                            message.content = '您好\n我是' + obj.data.name + '\n您可加我QQ：737398508\n也可拨打我电话：13018555107\n亦可直接留言，倘若在线，必定回复';
                        }
                        setTimeout(function () {
                            layim.setChatStatus('<span style="color:#FF5722;">在线</span>');
                            layim.getMessage(message);
                        },1000);
                    }, 1000);
                } else {
                    //console.log('聊过')
                }
            }
        });
    });
</script><div class="main-im">
    <div id="open_im" class="open-im" style="display: none;"></div>
    <div class="im_main" id="im_main">
        <div id="close_im" class="close-im"><a class="you" title="点击关闭" style="cursor: pointer"></a></div>
        <a onclick="multi_qq()" class="im-qq qq-a">
            <div class="qq-container"></div>
            <div class="qq-hover-c"><img class="img-qq" src="http://001.topaaa.com/skin/ypmili/css/img/qq.png"></div>
            <span>QQ在线咨询</span>
        </a>
        <script id="yptip_qq" type="text/template7">
            <p style="width:100%;background-color:#0098ff;font-size:16px;text-align:center;color:#fff;height:34px;line-height:34px;">客服团队</p><p style="line-height:40px;">客服潇潇：<a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> <span style="line-height:1.5;margin-left:10px;">客服靓靓：</span><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes" style="line-height:1.5;"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> </p><p style="line-height:30px;">客服恋恋：<a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> <span style="line-height:1.5;margin-left:10px;">客服萌萌：</span><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes" style="line-height:1.5;"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> </p><p><br /></p><p style="width:100%;background-color:#0098ff;font-size:16px;text-align:center;color:#fff;height:34px;line-height:34px;">合作渠道</p><p style="line-height:40px;">业务合作：<a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> <span style="line-height:1.5;margin-left:10px;">代理加盟：</span><a target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=261369834&site=qq&menu=yes" style="line-height:1.5;"><img border="0" src="http://wpa.qq.com/pa?p=2:261369834:51" alt="点击这里给我发消息" title="点击这里给我发消息" /></a> </p>        </script>
        <script>
            function multi_qq() {
                $('.layim-friend618').click();
            }
        </script>
        <a href="/app.php" target="_blank" class="qq-a" style="height: 130px">
            <div class="qq-container" style="height: 130px"></div>
            <div style="width: 95px;height: 95px"><img class="img-qq" src="/api/qrcode.php?url=http%3A%2F%2F001.topaaa.com%2Fapp.php" style="width: 95px;height: 95px;max-width: 95px;top: 5px;left: 5px"></div>
            <span>下载APP</span>
        </a>
        <div class="im-tel">
            <div><a href="/announce/index.php?typeid=2" target="_blank">如何发布试用</a></div>
            <div><a href="/announce/index.php?typeid=3" target="_blank">如何申请试用</a></div>
            <div><a href="/about/index.php?itemid=6" target="_blank">销量联盟网规</a></div>
            <div><a href="/announce/index.php?typeid=1" target="_blank" class="jsbz">网站公告</a></div>
        </div>
        <div class="im-footer" style="position:relative">
            <div class="go-top"><a class="you" title="返回顶部" style="cursor: pointer"></a></div>
            <div style="clear:both"></div>
        </div>
    </div>
    <script>
        $(function () {
            $(".go-top").click(function () {
                $('html,body').animate({scrollTop: 0}, 800);
            });
            $("#close_im").click(function () {
                $("#im_main").fadeOut(500, function () {
                    $("#open_im").fadeIn(500);
                });
            });
            $("#open_im").click(function () {
                $("#open_im").fadeOut(500, function () {
                    $("#im_main").fadeIn(500);
                });
            });
        });
    </script>
</div></body>
</html>